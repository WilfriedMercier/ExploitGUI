# -*- coding: utf-8 -*-
from   typing      import Dict
from   PyQt5.QtGui import QMovie
import os.path     as     opath
import yaml

def loadAnimations(path: str, animations: Dict[str, str]) -> Dict[str, QMovie]:
    r'''
    Load the animation files as QMovie objects.
    
    :param str path: path of the animations
    :param dict listAnim: list of animation file names
    
    :returns: list of QMovie animations
    :rtype: dict
    '''
    
    out = {}
    for name, file in animations.items():
        
        fname = opath.join(path, file)
        if not opath.isfile(fname):
            raise IOError(f'File {file} (expanded as {fname}) not found.')
            
        out[name] = QMovie(fname)
        
    return out

def loadBackground():
    
    pass

def setup(file):
    
    with open(file, 'r') as f:    
        conf = yaml.load(f, Loader=yaml.Loader)
        
    animations = loadAnimations('../' + conf['animations'], {name:value['file'] for name, value in conf['planets'].items()})
    conf.pop('animations')
    
    for name in conf['planets'].keys():
        conf['planets'][name]['animation'] = animations[name]
        conf['planets'][name].pop('file')
    
    print(conf)
    
setup('conf.yaml')